<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Belcoin - Login & Cadastro</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
    .container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.2); width: 350px; }
    .tabs { display: flex; justify-content: space-around; margin-bottom: 20px; }
    .tabs button { padding: 10px; cursor: pointer; background: #eee; border: none; border-radius: 4px; }
    .tabs button.active { background: #007bff; color: white; }
    .form { display: none; }
    .form.active { display: block; }
    input { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; }
    button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; }
    .msg { text-align: center; margin-top: 10px; font-weight: bold; color: green; }
  </style>
</head>
<body>
  <div class="container">
    <div class="tabs">
      <button id="tabLogin" class="active">Login</button>
      <button id="tabRegister">Cadastro</button>
    </div>

    <div id="loginForm" class="form active">
      <input type="email" id="loginEmail" placeholder="Email">
      <input type="password" id="loginSenha" placeholder="Senha">
      <button onclick="logar()">Entrar</button>
    </div>

    <div id="registerForm" class="form">
      <input type="text" id="nome" placeholder="Nome completo">
      <input type="text" id="cpf" placeholder="CPF">
      <input type="date" id="nascimento" placeholder="Data de nascimento">
      <input type="tel" id="telefone" placeholder="Telefone">
      <input type="email" id="email" placeholder="Email">
      <input type="password" id="senha" placeholder="Senha">
      <button onclick="registrar()">Cadastrar</button>
    </div>

    <div id="msg" class="msg"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBY10W0PXZAkz2Zr06iXa_T9t-GEgm_WgY",
      authDomain: "belcoin-38d95.firebaseapp.com",
      projectId: "belcoin-38d95",
      storageBucket: "belcoin-38d95.appspot.com",
      messagingSenderId: "351419236081",
      appId: "1:351419236081:web:d83537260c1dba5c767350",
      measurementId: "G-S9F5VEEP3J"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const tabLogin = document.getElementById('tabLogin');
    const tabRegister = document.getElementById('tabRegister');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const msg = document.getElementById('msg');

    tabLogin.onclick = () => {
      tabLogin.classList.add('active');
      tabRegister.classList.remove('active');
      loginForm.classList.add('active');
      registerForm.classList.remove('active');
    };

    tabRegister.onclick = () => {
      tabRegister.classList.add('active');
      tabLogin.classList.remove('active');
      registerForm.classList.add('active');
      loginForm.classList.remove('active');
    };

    function mostrarMensagem(texto) {
      msg.innerText = texto;
      setTimeout(() => { msg.innerText = ""; }, 10000);
    }

    function logar() {
      const email = document.getElementById('loginEmail').value;
      const senha = document.getElementById('loginSenha').value;
      auth.signInWithEmailAndPassword(email, senha)
        .then(() => {
          mostrarMensagem("Bem-vindo novamente à Belcoin");
          setTimeout(() => { window.location.href = "interface.html"; }, 10000);
        })
        .catch(err => alert("Erro no login: " + err.message));
    }

    function registrar() {
      const nome = document.getElementById('nome').value;
      const cpf = document.getElementById('cpf').value;
      const nascimento = document.getElementById('nascimento').value;
      const telefone = document.getElementById('telefone').value;
      const email = document.getElementById('email').value;
      const senha = document.getElementById('senha').value;

      if (!nome || !cpf || !nascimento || !telefone || !email || !senha) {
        alert("Preencha todos os campos!");
        return;
      }

      auth.createUserWithEmailAndPassword(email, senha)
        .then((userCredential) => {
          const userId = userCredential.user.uid;
          return db.collection("usuarios").doc(userId).set({
            nome, cpf, nascimento, telefone, email, saldo: 0
          });
        })
        .then(() => {
          mostrarMensagem("Bem-vindo à Belcoin!");
          setTimeout(() => { window.location.href = "interface.html"; }, 10000);
        })
        .catch(err => alert("Erro ao cadastrar: " + err.message));
    }
  </script>
</body>
</html>
